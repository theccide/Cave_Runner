<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cave Runner</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.3/pako.min.js"></script>
    <script src="Jam_Engine/Graphics.js"></script>
    <script src="Jam_Engine/Tools.js"></script>
    <script src="Jam_Engine/Grid.js"></script>
    <script src="Jam_Engine/AStar.js"></script>
    <script src="Entity.js"></script>
    <script src="Enemy.js"></script>
    <script src="Player.js"></script>
    <script src="LevelMap.js"></script>
    <script src="GameController.js"></script>
</head>
<body>
    <canvas id="myCanvas" width="1888" height="928"></canvas>
    <button id="playButton"></button>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        const width = canvas.width;
        const height = canvas.height;

        const gameController = new GameController();
        ctx.imageSmoothingEnabled= false

        // Store the timestamp of the previous frame
        let lastTimestamp = 0;

        // Game loop
        function update(deltaTime) {
            gameController.update(deltaTime);
        }

        function render() {
            //clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            //add background
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);            
        }

        function gameLoop(timestamp) {
            // Calculate delta time
            const dt = (timestamp - lastTimestamp) / 1000; // Convert to seconds
            lastTimestamp = timestamp;

            // Update and render the game
            render();
            update(dt);

            requestAnimationFrame(gameLoop);
        }

        gameController.start();

        const getMouseInput=(event)=>{ gameController.getMouseInput(event);}    
        const getMouseMoveInput=(event)=>{gameController.getMouseMoveInput(event);}
        const getKeyboardInput=(event)=>{gameController.getKeyboardInput(event);}
        
        // Start the game loop
        requestAnimationFrame(gameLoop);
    </script>
    <script src="Jam_Engine/InputHandler.js"></script>
</body>
</html>
